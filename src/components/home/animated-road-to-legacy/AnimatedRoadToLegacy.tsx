import { useLoading } from "@/context/LoadingContext";
import { useEffect, useRef } from "react";
import "./AnimatedRoadToLegacy.css";

const AnimatedRoadToLegacy = () => {
  const { loading } = useLoading();
  const svgRef = useRef<SVGSVGElement | null>(null);

  useEffect(() => {
    if (!loading) {
      function setTextAnimation(
        delay: number,
        duration: number,
        strokeWidth: number,
        timingFunction: string,
        strokeColor: string,
        repeat: boolean
      ) {
        const paths = svgRef.current?.querySelectorAll("path");
        const mode = repeat ? "infinite" : "forwards";
        paths?.forEach((path, i) => {
          const length = (path as SVGPathElement).getTotalLength();
          path.style.strokeDashoffset = `${length}px`;
          path.style.strokeDasharray = `${length}px`;
          path.style.strokeWidth = `${strokeWidth}px`;
          path.style.stroke = strokeColor;
          path.style.animation = `${duration}s svg-text-animation ${mode} ${timingFunction}`;
          path.style.animationDelay = `${i * delay}s`;
        });
      }

      // Trigger animation when loading finishes
      setTextAnimation(0.1, 3.2, 2, "ease-in", "#ffffff", false);
    }
  }, [loading]); // Re-run when loading changes

  // Only render after loading is false
  if (loading) return null;

  return (
    <div className="flex items-center justify-center w-[300px] sm:w-[450px] md:w-[450px] lg:w-[500px] ">
      <svg
        width="577.04"
        height="72.72"
        viewBox="0 0 577.04 72.72"
        xmlns="http://www.w3.org/2000/svg"
        className="custom-porto-svg-logo active"
        ref={svgRef}
      >
        <g
          id="svgGroup"
          strokeLinecap="round"
          fillRule="evenodd"
          fontSize="9pt"
          stroke="#000"
          strokeWidth="0.25mm"
          fill="none"
          style={{ stroke: "#000", strokeWidth: "0.25mm", fill: "none" }}
        >
          <path
            d="M 28.12 31.895 L 39.886 53.133 L 27.972 53.133 L 17.686 33.597 L 10.286 33.597 L 10.286 53.133 L 0 53.133 L 0 11.767 A 20.314 20.314 0 0 1 0.217 8.692 Q 0.77 5.087 2.738 3.146 A 7.918 7.918 0 0 1 5.442 1.448 Q 7.829 0.509 11.422 0.449 A 29.682 29.682 0 0 1 11.914 0.445 L 20.646 0.445 A 20.815 20.815 0 0 1 26.07 1.114 A 15.068 15.068 0 0 1 33.115 5.218 A 16.252 16.252 0 0 1 37.666 15.498 A 21.764 21.764 0 0 1 37.74 17.317 A 17.152 17.152 0 0 1 37.049 22.275 A 14.399 14.399 0 0 1 34.965 26.53 A 15.675 15.675 0 0 1 31.658 29.974 A 13.521 13.521 0 0 1 28.12 31.895 Z M 19.98 9.621 L 14.874 9.621 Q 10.286 9.621 10.286 14.283 L 10.286 25.013 L 19.98 25.013 A 7.668 7.668 0 0 0 22.76 24.525 A 6.915 6.915 0 0 0 25.345 22.756 A 7.76 7.76 0 0 0 27.429 17.855 A 10.201 10.201 0 0 0 27.454 17.132 A 9.063 9.063 0 0 0 27.144 14.699 A 6.823 6.823 0 0 0 25.419 11.693 A 6.795 6.795 0 0 0 21.597 9.75 A 9.685 9.685 0 0 0 19.98 9.621 Z"
            id="0"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 87.024 24.347 L 87.024 28.343 A 55.668 55.668 0 0 1 86.64 35.133 Q 85.75 42.348 82.801 46.572 A 14.939 14.939 0 0 1 82.029 47.583 Q 77.806 52.651 69.27 53.434 A 35.744 35.744 0 0 1 66.008 53.577 Q 54.982 53.577 50.061 47.583 A 17.814 17.814 0 0 1 47.16 42.31 Q 45.342 37.305 45.161 29.815 A 69.87 69.87 0 0 1 45.14 28.121 L 45.14 24.273 A 48.547 48.547 0 0 1 45.535 17.861 Q 45.977 14.554 46.913 11.87 A 18.673 18.673 0 0 1 50.135 5.995 Q 55.13 0.001 65.971 0.001 A 30.707 30.707 0 0 1 71.903 0.536 Q 78.328 1.802 81.918 6.069 Q 85.701 10.564 86.681 18.43 A 47.938 47.938 0 0 1 87.024 24.347 Z M 76.738 28.121 L 76.738 25.383 A 46.313 46.313 0 0 0 76.547 21.032 Q 76.351 18.963 75.955 17.221 A 18.997 18.997 0 0 0 74.962 14.061 A 7.518 7.518 0 0 0 69.559 9.569 Q 68.01 9.177 66.082 9.177 A 14.849 14.849 0 0 0 62.854 9.502 Q 60.923 9.932 59.556 10.935 A 7.337 7.337 0 0 0 57.128 14.061 A 17.411 17.411 0 0 0 56.177 17.122 Q 55.426 20.518 55.426 25.383 L 55.426 28.121 A 53.948 53.948 0 0 0 55.573 32.254 Q 56.051 38.447 58.09 40.997 Q 59.029 42.271 60.789 43.211 A 12.205 12.205 0 0 0 61.161 43.402 A 9.364 9.364 0 0 0 63.553 44.181 Q 64.71 44.401 66.045 44.401 A 14.107 14.107 0 0 0 68.22 44.242 Q 69.427 44.054 70.437 43.641 A 8.182 8.182 0 0 0 70.892 43.439 A 10.523 10.523 0 0 0 72.471 42.512 Q 73.376 41.862 74 41.071 A 7.931 7.931 0 0 0 74.927 39.558 Q 75.273 38.832 75.536 37.965 A 14.593 14.593 0 0 0 75.702 37.371 A 23.442 23.442 0 0 0 76.334 34.371 Q 76.561 32.832 76.661 31.047 A 52.621 52.621 0 0 0 76.738 28.121 Z"
            id="1"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 119.14 4.885 L 136.012 53.133 L 125.282 53.133 L 122.322 44.031 L 104.636 44.031 L 101.75 53.133 L 91.02 53.133 L 107.892 4.885 Q 109.002 2.369 110.371 1.407 Q 111.74 0.445 113.738 0.445 Q 115.736 0.445 116.957 1.333 Q 118.178 2.221 119.14 4.885 Z M 107.226 35.373 L 119.954 35.373 L 113.738 14.505 L 107.226 35.373 Z"
            id="2"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 183.002 26.567 L 183.076 32.265 A 58.952 58.952 0 0 1 182.75 36.077 Q 182.392 39.054 181.744 41.367 Q 180.708 45.067 177.674 48.101 A 16.107 16.107 0 0 1 170.857 52.082 Q 168.305 52.862 165.226 53.063 A 33.821 33.821 0 0 1 163.022 53.133 A 67.257 67.257 0 0 1 157.88 52.951 Q 152.909 52.569 149.853 51.378 A 10.942 10.942 0 0 1 147.482 50.136 A 8.979 8.979 0 0 1 144.352 46.012 Q 143.723 44.431 143.458 42.433 A 23.891 23.891 0 0 1 143.264 39.295 L 143.264 0.445 L 163.762 0.445 Q 172.642 0.445 177.674 5.477 Q 181.744 9.547 182.484 15.393 A 53.893 53.893 0 0 1 182.757 18.265 Q 182.986 21.503 183.001 25.931 A 185.509 185.509 0 0 1 183.002 26.567 Z M 162.8 9.621 L 153.55 9.621 L 153.55 38.777 A 6.797 6.797 0 0 0 153.704 40.277 Q 153.915 41.209 154.417 41.873 A 3.571 3.571 0 0 0 155.548 42.847 Q 157.546 43.957 162.689 43.957 A 12.963 12.963 0 0 0 165.798 43.606 A 8.527 8.527 0 0 0 170.496 40.701 A 7.153 7.153 0 0 0 171.595 38.821 Q 172.093 37.594 172.309 36.002 A 31.226 31.226 0 0 0 172.487 34.293 Q 172.716 31.414 172.716 26.641 A 160.379 160.379 0 0 0 172.691 23.679 Q 172.615 19.565 172.309 17.428 A 11.894 11.894 0 0 0 171.864 15.453 Q 171.501 14.33 170.923 13.455 A 6.707 6.707 0 0 0 170.496 12.877 A 8.621 8.621 0 0 0 165.306 9.851 A 12.997 12.997 0 0 0 162.8 9.621 Z"
            id="3"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 243.46 0.445 L 243.46 9.621 L 229.326 9.621 L 229.326 53.133 L 219.04 53.133 L 219.04 9.621 L 204.98 9.621 L 204.98 0.445 L 243.46 0.445 Z"
            id="5"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 290.08 24.347 L 290.08 28.343 A 55.668 55.668 0 0 1 289.696 35.133 Q 288.806 42.348 285.857 46.572 A 14.939 14.939 0 0 1 285.085 47.583 Q 280.862 52.651 272.326 53.434 A 35.744 35.744 0 0 1 269.064 53.577 Q 258.038 53.577 253.117 47.583 A 17.814 17.814 0 0 1 250.216 42.31 Q 248.398 37.305 248.217 29.815 A 69.87 69.87 0 0 1 248.196 28.121 L 248.196 24.273 A 48.547 48.547 0 0 1 248.591 17.861 Q 249.033 14.554 249.969 11.87 A 18.673 18.673 0 0 1 253.191 5.995 Q 258.186 0.001 269.027 0.001 A 30.707 30.707 0 0 1 274.959 0.536 Q 281.384 1.802 284.974 6.069 Q 288.757 10.564 289.737 18.43 A 47.938 47.938 0 0 1 290.08 24.347 Z M 279.794 28.121 L 279.794 25.383 A 46.313 46.313 0 0 0 279.603 21.032 Q 279.407 18.963 279.011 17.221 A 18.997 18.997 0 0 0 278.018 14.061 A 7.518 7.518 0 0 0 272.615 9.569 Q 271.066 9.177 269.138 9.177 A 14.849 14.849 0 0 0 265.91 9.502 Q 263.979 9.932 262.612 10.935 A 7.337 7.337 0 0 0 260.184 14.061 A 17.411 17.411 0 0 0 259.233 17.122 Q 258.482 20.518 258.482 25.383 L 258.482 28.121 A 53.948 53.948 0 0 0 258.629 32.254 Q 259.107 38.447 261.146 40.997 Q 262.085 42.271 263.845 43.211 A 12.205 12.205 0 0 0 264.217 43.402 A 9.364 9.364 0 0 0 266.609 44.181 Q 267.766 44.401 269.101 44.401 A 14.107 14.107 0 0 0 271.276 44.242 Q 272.483 44.054 273.493 43.641 A 8.182 8.182 0 0 0 273.948 43.439 A 10.523 10.523 0 0 0 275.527 42.512 Q 276.432 41.862 277.056 41.071 A 7.931 7.931 0 0 0 277.983 39.558 Q 278.329 38.832 278.592 37.965 A 14.593 14.593 0 0 0 278.758 37.371 A 23.442 23.442 0 0 0 279.39 34.371 Q 279.617 32.832 279.717 31.047 A 52.621 52.621 0 0 0 279.794 28.121 Z"
            id="6"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 348.762 43.957 L 348.762 53.133 L 333.074 53.133 A 36.342 36.342 0 0 1 328.586 52.876 Q 323.721 52.268 320.908 50.226 A 9.802 9.802 0 0 1 320.235 49.692 A 10.389 10.389 0 0 1 317.333 45.354 Q 316.706 43.656 316.451 41.552 A 25.581 25.581 0 0 1 316.276 38.481 L 316.276 0.445 L 326.562 0.445 L 326.562 38.481 Q 326.562 41.268 327.693 42.508 A 2.904 2.904 0 0 0 327.968 42.773 Q 329.144 43.763 331.925 43.925 A 19.794 19.794 0 0 0 333.074 43.957 L 348.762 43.957 Z"
            id="8"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 391.682 43.957 L 391.682 53.133 L 373.034 53.133 A 40.81 40.81 0 0 1 368.925 52.941 Q 364.619 52.504 362.03 51.069 A 8.823 8.823 0 0 1 360.565 50.062 Q 357.107 47.103 356.981 39.78 A 32.549 32.549 0 0 1 356.976 39.221 L 356.976 0.445 L 391.682 0.445 L 391.682 9.621 L 367.262 9.621 L 367.262 21.979 L 384.356 21.979 L 383.616 31.155 L 367.262 31.155 L 367.262 38.481 Q 367.262 41.268 368.393 42.508 A 2.904 2.904 0 0 0 368.668 42.773 Q 369.844 43.763 372.625 43.925 A 19.794 19.794 0 0 0 373.774 43.957 L 391.682 43.957 Z"
            id="9"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 398.49 28.343 L 398.49 21.831 Q 398.49 13.614 401.938 8.278 A 17.765 17.765 0 0 1 403.892 5.773 A 17.745 17.745 0 0 1 413.538 0.51 A 26.259 26.259 0 0 1 418.84 0.001 A 25.611 25.611 0 0 1 425.596 0.847 A 18.93 18.93 0 0 1 434.158 5.773 Q 437.529 9.143 438.108 15.305 A 28.63 28.63 0 0 1 438.228 17.983 L 428.608 17.983 A 11.862 11.862 0 0 0 428.126 14.445 Q 426.479 9.177 419.21 9.177 A 12.322 12.322 0 0 0 417.066 9.354 Q 415.785 9.581 414.733 10.097 A 7.496 7.496 0 0 0 414.437 10.25 A 10.756 10.756 0 0 0 413.058 11.139 Q 412.101 11.872 411.514 12.729 A 6.749 6.749 0 0 0 410.905 13.853 Q 410.391 15.038 410.056 16.76 A 22.408 22.408 0 0 0 410.034 16.873 Q 409.662 18.844 409.519 20.354 A 20.499 20.499 0 0 0 409.442 21.461 Q 409.368 23.311 409.368 26.419 A 417.212 417.212 0 0 0 409.37 27.681 Q 409.375 29.274 409.393 30.139 A 34.582 34.582 0 0 0 409.405 30.6 A 34.724 34.724 0 0 0 409.433 31.22 Q 409.483 32.163 409.599 33.706 A 239.773 239.773 0 0 0 409.627 34.078 Q 409.77 35.928 410.043 36.968 A 4.99 4.99 0 0 0 410.219 37.519 A 25.49 25.49 0 0 0 410.51 38.224 Q 410.858 39.037 411.369 40.111 A 81.638 81.638 0 0 0 411.403 40.183 A 6.795 6.795 0 0 0 412.014 41.229 Q 412.421 41.794 412.907 42.172 A 3.685 3.685 0 0 0 413.364 42.477 A 12.442 12.442 0 0 0 419.65 44.389 A 15.024 15.024 0 0 0 420.246 44.401 A 11.705 11.705 0 0 0 423.983 43.839 Q 427.312 42.723 429.111 39.387 A 12.38 12.38 0 0 0 429.348 38.925 L 429.348 35.373 L 422.984 35.373 L 422.984 26.789 L 438.154 26.789 L 438.154 42.699 Q 435.86 48.101 430.902 50.839 A 22.086 22.086 0 0 1 422.155 53.464 A 27.17 27.17 0 0 1 419.654 53.577 A 31.489 31.489 0 0 1 413.711 53.054 Q 410.374 52.412 407.817 50.979 A 14.644 14.644 0 0 1 403.485 47.324 Q 399.941 42.887 398.912 35.189 A 51.802 51.802 0 0 1 398.49 28.343 Z"
            id="10"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 471.972 4.885 L 488.844 53.133 L 478.114 53.133 L 475.154 44.031 L 457.468 44.031 L 454.582 53.133 L 443.852 53.133 L 460.724 4.885 Q 461.834 2.369 463.203 1.407 Q 464.572 0.445 466.57 0.445 Q 468.568 0.445 469.789 1.333 Q 471.01 2.221 471.972 4.885 Z M 460.058 35.373 L 472.786 35.373 L 466.57 14.505 L 460.058 35.373 Z"
            id="11"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 522.736 32.709 L 532.282 32.709 Q 532.282 40.01 529.634 44.858 A 16.327 16.327 0 0 1 527.25 48.175 A 16.379 16.379 0 0 1 518.861 52.939 A 24.961 24.961 0 0 1 513.042 53.577 Q 494.05 53.577 492.913 32.583 A 51.041 51.041 0 0 1 492.84 29.823 L 492.84 25.383 Q 492.84 6.661 503.2 1.925 Q 507.27 0.001 513.042 0.001 A 25.097 25.097 0 0 1 519.146 0.705 A 18.051 18.051 0 0 1 526.769 4.626 A 14.945 14.945 0 0 1 531.491 12.695 A 23.094 23.094 0 0 1 532.06 17.983 L 522.44 17.983 A 19.626 19.626 0 0 0 521.771 15.349 Q 520.946 12.889 519.554 11.397 A 6.337 6.337 0 0 0 516.995 9.768 Q 515.334 9.177 513.042 9.177 Q 507.862 9.177 505.346 12.433 Q 503.57 14.727 503.274 20.277 A 34.311 34.311 0 0 0 503.196 21.51 Q 503.126 23.001 503.126 25.087 L 503.126 29.675 A 48.151 48.151 0 0 0 503.265 33.48 Q 503.7 38.938 505.494 41.293 A 7.73 7.73 0 0 0 509.602 43.964 Q 510.909 44.333 512.486 44.39 A 16.256 16.256 0 0 0 513.079 44.401 A 14.498 14.498 0 0 0 515.587 44.2 Q 518.743 43.644 520.183 41.552 Q 521.961 38.969 522.614 33.801 A 40.461 40.461 0 0 0 522.736 32.709 Z"
            id="12"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 565.804 0.445 L 576.978 0.445 L 561.142 31.525 L 561.142 53.133 L 550.93 53.133 L 550.93 31.525 L 535.094 0.445 L 546.268 0.445 L 556.11 21.683 L 565.804 0.445 Z"
            id="13"
            vectorEffect="non-scaling-stroke"
          />
        </g>
      </svg>
    </div>
  );
};

export default AnimatedRoadToLegacy;
