import { useLoading } from "@/context/LoadingContext";
import { useEffect, useRef } from "react";
import "./AnimatedRoadToLegacy.css";

const AnimatedRoadToLegacy = () => {
  const { loading } = useLoading();
  const svgRef = useRef<SVGSVGElement | null>(null);

  useEffect(() => {
    if (!loading) {
      function setTextAnimation(
        delay: number,
        duration: number,
        strokeWidth: number,
        timingFunction: string,
        strokeColor: string,
        repeat: boolean
      ) {
        const paths = svgRef.current?.querySelectorAll("path");
        const mode = repeat ? "infinite" : "forwards";
        paths?.forEach((path, i) => {
          const length = (path as SVGPathElement).getTotalLength();
          path.style.strokeDashoffset = `${length}px`;
          path.style.strokeDasharray = `${length}px`;
          path.style.strokeWidth = `${strokeWidth}px`;
          path.style.stroke = strokeColor;
          path.style.animation = `${duration}s svg-text-animation ${mode} ${timingFunction}`;
          path.style.animationDelay = `${i * delay}s`;
        });
      }

      // Trigger animation when loading finishes
      setTextAnimation(0.1, 3.2, 2, "ease-in", "#ffffff", false);
    }
  }, [loading]); // Re-run when loading changes

  // Only render after loading is false
  if (loading) return null;

  return (
    <div className="flex items-center justify-center w-[300px] sm:w-[450px] md:w-[450px] lg:w-[500px] ">
      <svg
        width="577.04"
        height="72.72"
        viewBox="0 0 577.04 72.72"
        xmlns="http://www.w3.org/2000/svg"
        className="custom-porto-svg-logo active"
        ref={svgRef}
      >
        <g
          id="svgGroup"
          strokeLinecap="round"
          fillRule="evenodd"
          fontSize="9pt"
          stroke="#000"
          strokeWidth="0.25mm"
          fill="none"
          style={{ stroke: "#000", strokeWidth: "0.25mm", fill: "none" }}
        >
          <path
            d="M 0 54.88 L 0 0.72 Q 0.543 0.72 2.44 0.683 A 694.523 694.523 0 0 0 2.56 0.68 A 191.945 191.945 0 0 1 4.676 0.65 Q 5.798 0.64 7.04 0.64 Q 9.52 0.64 12 0.6 Q 14.48 0.56 16.08 0.56 A 40.211 40.211 0 0 1 21.236 0.867 Q 26.846 1.595 30.072 4.048 A 11.397 11.397 0 0 1 30.56 4.44 A 12.654 12.654 0 0 1 34.867 12.222 A 18.674 18.674 0 0 1 35.12 15.36 A 15.785 15.785 0 0 1 34.313 20.472 A 14.174 14.174 0 0 1 32.8 23.6 A 11.14 11.14 0 0 1 29.16 27.075 Q 27.448 28.119 25.2 28.8 A 13.335 13.335 0 0 1 28.407 31.386 A 15.895 15.895 0 0 1 29.2 32.32 A 28.559 28.559 0 0 1 30.832 34.64 Q 31.748 36.079 32.64 37.8 Q 34.32 41.04 36.08 45.32 Q 37.812 49.532 40.087 54.713 A 597.647 597.647 0 0 0 40.16 54.88 L 29.84 54.88 A 780.784 780.784 0 0 0 27.896 50.399 Q 26.355 46.88 25.08 44.08 A 68.545 68.545 0 0 0 23.567 40.957 Q 22.32 38.55 21.12 36.8 Q 19.529 34.48 17.746 33.204 A 9.423 9.423 0 0 0 17 32.72 Q 14.8 31.44 11.84 31.44 L 9.52 31.44 L 9.52 54.88 L 0 54.88 Z M 9.52 7.36 L 9.52 24.48 L 15.68 24.48 Q 18.78 24.48 20.904 23.523 A 7.569 7.569 0 0 0 22.6 22.48 A 6.425 6.425 0 0 0 24.79 18.875 A 10.052 10.052 0 0 0 25.04 16.56 Q 25.04 14.8 24.56 13.12 Q 24.08 11.44 22.92 10.16 A 7.109 7.109 0 0 0 21.311 8.854 A 9.715 9.715 0 0 0 19.8 8.12 A 10.086 10.086 0 0 0 18.042 7.628 Q 16.638 7.36 14.88 7.36 L 9.52 7.36 Z"
            id="0"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 76.24 1.92 A 18.095 18.095 0 0 0 75.192 1.485 Q 71.276 0 66 0 A 30.022 30.022 0 0 0 60.944 0.406 A 21.682 21.682 0 0 0 55.44 2.08 Q 50.96 4.16 48.04 7.96 Q 45.12 11.76 43.72 17 Q 42.32 22.24 42.32 28.48 A 63.328 63.328 0 0 0 42.321 28.879 Q 42.36 35.035 43.6 39.84 A 26.395 26.395 0 0 0 44.599 42.936 A 20.854 20.854 0 0 0 47.64 48.28 Q 50.4 51.76 54.68 53.56 Q 57.221 54.629 60.369 55.063 A 33.633 33.633 0 0 0 64.96 55.36 A 35.818 35.818 0 0 0 65.315 55.359 Q 71.17 55.301 75.48 53.32 Q 79.92 51.28 82.84 47.6 A 21.9 21.9 0 0 0 85.104 44.097 A 26.563 26.563 0 0 0 87.16 38.76 A 38.307 38.307 0 0 0 88.129 33.951 A 48.332 48.332 0 0 0 88.56 27.36 A 54.648 54.648 0 0 0 88.297 21.887 A 41.124 41.124 0 0 0 87.28 15.96 Q 86 10.88 83.24 7.36 Q 80.48 3.84 76.24 1.92 Z M 64.88 7.36 A 13.105 13.105 0 0 0 62.313 7.598 Q 60.454 7.97 59.04 8.92 A 11.204 11.204 0 0 0 55.851 12.221 A 13.596 13.596 0 0 0 55.28 13.2 A 18.277 18.277 0 0 0 53.933 16.539 A 24.534 24.534 0 0 0 53.24 19.6 A 45.687 45.687 0 0 0 52.732 24.323 A 57.029 57.029 0 0 0 52.64 27.6 A 53.388 53.388 0 0 0 52.955 33.492 A 46.614 46.614 0 0 0 53.2 35.36 A 22.892 22.892 0 0 0 54.051 39.009 A 17.923 17.923 0 0 0 55.24 41.84 Q 56.72 44.64 59.32 46.32 Q 61.564 47.77 64.97 47.969 A 19.079 19.079 0 0 0 66.08 48 Q 69.52 48 71.88 46.48 A 11.126 11.126 0 0 0 75.449 42.726 A 13.182 13.182 0 0 0 75.68 42.32 A 17.123 17.123 0 0 0 76.973 39.233 A 23.409 23.409 0 0 0 77.72 36.04 Q 78.32 32.4 78.32 28.16 A 54.071 54.071 0 0 0 77.921 21.503 A 48.797 48.797 0 0 0 77.76 20.32 A 23.969 23.969 0 0 0 76.905 16.574 A 18.803 18.803 0 0 0 75.72 13.68 Q 74.24 10.8 71.64 9.08 Q 69.04 7.36 64.88 7.36 Z"
            id="1"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 89.76 54.88 L 110.56 0.72 L 118.08 0.72 L 138.96 54.88 L 128.8 54.88 L 123.84 40.72 L 104.32 40.72 L 99.2 54.88 L 89.76 54.88 Z M 106.88 33.68 L 121.36 33.68 A 425.888 425.888 0 0 1 118.989 26.836 Q 117.884 23.552 116.96 20.6 Q 115.551 16.098 114.658 13.074 A 204.891 204.891 0 0 1 114.16 11.36 Q 113.158 14.581 111.58 19.593 A 5194.547 5194.547 0 0 1 111.2 20.8 Q 109.36 26.64 106.88 33.68 Z"
            id="2"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 144.16 54.88 L 144.16 0.72 A 30.322 30.322 0 0 0 144.466 0.718 Q 145.123 0.712 146.56 0.68 Q 148.278 0.643 150.414 0.64 A 263.598 263.598 0 0 1 150.72 0.64 Q 153.04 0.64 155.52 0.6 Q 157.225 0.573 158.628 0.564 A 198.292 198.292 0 0 1 159.84 0.56 Q 168.658 0.56 174.517 3.403 A 19.291 19.291 0 0 1 180 7.32 Q 185.415 12.9 186.36 22.977 A 47.825 47.825 0 0 1 186.56 27.44 A 42.586 42.586 0 0 1 185.871 35.359 Q 185.013 39.884 183.09 43.418 A 21.474 21.474 0 0 1 179.84 47.92 A 20.566 20.566 0 0 1 171.628 53.119 Q 166.24 55.04 158.8 55.04 Q 156.32 55.04 153.96 55 Q 151.6 54.96 149.64 54.96 Q 148.293 54.96 147.191 54.941 A 89.816 89.816 0 0 1 146.24 54.92 Q 144.914 54.883 144.266 54.881 A 23.646 23.646 0 0 0 144.16 54.88 Z M 153.68 7.76 L 153.68 47.84 A 16.348 16.348 0 0 0 154.346 47.886 Q 154.694 47.903 155.097 47.912 A 40.542 40.542 0 0 0 155.96 47.92 L 160 47.92 Q 168.4 47.92 172.32 43 A 15.67 15.67 0 0 0 174.858 38.204 Q 175.614 35.968 175.956 33.222 A 39.7 39.7 0 0 0 176.24 28.32 A 40.568 40.568 0 0 0 175.98 23.627 A 31.336 31.336 0 0 0 175.32 19.88 A 18.521 18.521 0 0 0 173.905 15.947 A 15.364 15.364 0 0 0 172.28 13.36 A 13.96 13.96 0 0 0 166.943 9.207 A 16.232 16.232 0 0 0 166.84 9.16 A 15.953 15.953 0 0 0 163.402 8.098 Q 161.803 7.785 159.969 7.706 A 29.281 29.281 0 0 0 158.72 7.68 Q 156.902 7.68 155.67 7.719 A 52.796 52.796 0 0 0 155.64 7.72 Q 154.691 7.751 154.046 7.758 A 33.027 33.027 0 0 1 153.68 7.76 Z"
            id="3"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 211.2 0.72 L 248.96 0.72 L 247.76 7.92 L 234.32 7.92 L 234.32 54.88 L 224.88 54.88 L 224.88 7.92 L 211.2 7.92 L 211.2 0.72 Z"
            id="5"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 284.96 1.92 A 18.095 18.095 0 0 0 283.912 1.485 Q 279.996 0 274.72 0 A 30.022 30.022 0 0 0 269.664 0.406 A 21.682 21.682 0 0 0 264.16 2.08 Q 259.68 4.16 256.76 7.96 Q 253.84 11.76 252.44 17 Q 251.04 22.24 251.04 28.48 A 63.328 63.328 0 0 0 251.041 28.879 Q 251.08 35.035 252.32 39.84 A 26.395 26.395 0 0 0 253.319 42.936 A 20.854 20.854 0 0 0 256.36 48.28 Q 259.12 51.76 263.4 53.56 Q 265.941 54.629 269.089 55.063 A 33.633 33.633 0 0 0 273.68 55.36 A 35.818 35.818 0 0 0 274.035 55.359 Q 279.89 55.301 284.2 53.32 Q 288.64 51.28 291.56 47.6 A 21.9 21.9 0 0 0 293.824 44.097 A 26.563 26.563 0 0 0 295.88 38.76 A 38.307 38.307 0 0 0 296.849 33.951 A 48.332 48.332 0 0 0 297.28 27.36 A 54.648 54.648 0 0 0 297.017 21.887 A 41.124 41.124 0 0 0 296 15.96 Q 294.72 10.88 291.96 7.36 Q 289.2 3.84 284.96 1.92 Z M 273.6 7.36 A 13.105 13.105 0 0 0 271.033 7.598 Q 269.174 7.97 267.76 8.92 A 11.204 11.204 0 0 0 264.571 12.221 A 13.596 13.596 0 0 0 264 13.2 A 18.277 18.277 0 0 0 262.653 16.539 A 24.534 24.534 0 0 0 261.96 19.6 A 45.687 45.687 0 0 0 261.452 24.323 A 57.029 57.029 0 0 0 261.36 27.6 A 53.388 53.388 0 0 0 261.675 33.492 A 46.614 46.614 0 0 0 261.92 35.36 A 22.892 22.892 0 0 0 262.771 39.009 A 17.923 17.923 0 0 0 263.96 41.84 Q 265.44 44.64 268.04 46.32 Q 270.284 47.77 273.69 47.969 A 19.079 19.079 0 0 0 274.8 48 Q 278.24 48 280.6 46.48 A 11.126 11.126 0 0 0 284.169 42.726 A 13.182 13.182 0 0 0 284.4 42.32 A 17.123 17.123 0 0 0 285.693 39.233 A 23.409 23.409 0 0 0 286.44 36.04 Q 287.04 32.4 287.04 28.16 A 54.071 54.071 0 0 0 286.641 21.503 A 48.797 48.797 0 0 0 286.48 20.32 A 23.969 23.969 0 0 0 285.625 16.574 A 18.803 18.803 0 0 0 284.44 13.68 Q 282.96 10.8 280.36 9.08 Q 277.76 7.36 273.6 7.36 Z"
            id="6"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 326.88 54.88 L 326.88 0.72 L 336.4 0.72 L 336.4 47.68 L 356.64 47.68 L 356.64 54.88 L 326.88 54.88 Z"
            id="8"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 362.24 54.88 L 362.24 0.72 L 394.4 0.72 L 394.4 7.92 L 371.76 7.92 L 371.76 23.04 L 390.4 23.04 L 389.2 30.32 L 371.76 30.32 L 371.76 47.68 L 395.6 47.68 L 395.6 54.88 L 362.24 54.88 Z"
            id="9"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 427.2 72.72 L 423.52 66.4 A 24.988 24.988 0 0 0 425.978 65.033 Q 427.141 64.292 428.046 63.496 A 12.281 12.281 0 0 0 429.04 62.52 Q 430.96 60.4 431.88 58.2 A 13.627 13.627 0 0 0 432.807 54.918 A 12.291 12.291 0 0 0 432.92 53.8 Q 433.04 51.6 433.04 49.68 L 433.04 48.56 Q 431.2 51.92 427.68 53.72 A 16.236 16.236 0 0 1 422.644 55.298 A 21.185 21.185 0 0 1 419.52 55.52 A 22.125 22.125 0 0 1 415.42 55.159 A 15.809 15.809 0 0 1 410.88 53.6 Q 407.28 51.68 404.96 48.12 A 22.695 22.695 0 0 1 402.667 43.468 A 29.94 29.94 0 0 1 401.56 39.6 A 46.089 46.089 0 0 1 400.694 33.753 A 60.53 60.53 0 0 1 400.48 28.56 A 47.457 47.457 0 0 1 400.936 21.857 A 38.567 38.567 0 0 1 401.92 17.08 A 28.329 28.329 0 0 1 404.008 11.641 A 23.485 23.485 0 0 1 406.28 8.04 Q 409.2 4.24 413.64 2.12 Q 418.076 0.002 424.149 0 A 23.297 23.297 0 0 1 424.16 0 A 27.084 27.084 0 0 1 428.085 0.269 Q 430.138 0.57 431.862 1.209 A 14.781 14.781 0 0 1 433.16 1.76 Q 436.107 3.185 438.031 4.872 A 13.873 13.873 0 0 1 438.88 5.68 L 434.24 11.76 A 14.082 14.082 0 0 0 430.164 8.946 A 16.696 16.696 0 0 0 429.16 8.52 Q 426.16 7.36 423.04 7.36 A 12.257 12.257 0 0 0 420.43 7.624 A 8.772 8.772 0 0 0 417.28 8.96 A 11.443 11.443 0 0 0 414.103 12.306 A 13.933 13.933 0 0 0 413.52 13.32 Q 412.08 16.08 411.44 19.8 A 44.464 44.464 0 0 0 410.863 25.161 A 53.061 53.061 0 0 0 410.8 27.76 Q 410.8 32.32 411.4 36.04 Q 411.947 39.433 413.027 41.961 A 17.667 17.667 0 0 0 413.24 42.44 A 12.303 12.303 0 0 0 414.569 44.689 A 9.382 9.382 0 0 0 416.48 46.6 A 7.475 7.475 0 0 0 419.851 47.97 A 9.952 9.952 0 0 0 421.36 48.08 A 8.777 8.777 0 0 0 423.928 47.683 A 10.911 10.911 0 0 0 425.12 47.24 Q 427.04 46.4 428.6 44.84 A 11.567 11.567 0 0 0 430.671 41.988 A 13.785 13.785 0 0 0 431.12 41.04 A 11.709 11.709 0 0 0 431.939 38.032 A 15.281 15.281 0 0 0 432.08 35.92 L 432.08 28.64 L 441.44 28.64 L 441.44 52.72 Q 441.44 56.55 440.627 59.395 A 15.074 15.074 0 0 1 440.12 60.88 Q 438.8 64.16 436.76 66.36 Q 434.72 68.56 432.2 70.04 Q 429.68 71.52 427.2 72.72 Z"
            id="10"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 445.04 54.88 L 465.84 0.72 L 473.36 0.72 L 494.24 54.88 L 484.08 54.88 L 479.12 40.72 L 459.6 40.72 L 454.48 54.88 L 445.04 54.88 Z M 462.16 33.68 L 476.64 33.68 A 425.888 425.888 0 0 1 474.269 26.836 Q 473.164 23.552 472.24 20.6 Q 470.831 16.098 469.938 13.074 A 204.891 204.891 0 0 1 469.44 11.36 Q 468.438 14.581 466.86 19.593 A 5194.547 5194.547 0 0 1 466.48 20.8 Q 464.64 26.64 462.16 33.68 Z"
            id="11"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 532.08 5.76 L 527.2 11.6 Q 525.28 9.52 523.16 8.44 A 9.789 9.789 0 0 0 520.165 7.5 A 12.813 12.813 0 0 0 518.24 7.36 A 12.578 12.578 0 0 0 515.536 7.637 A 9.102 9.102 0 0 0 512.44 8.92 Q 510.08 10.48 508.64 13.24 A 19.539 19.539 0 0 0 507.273 16.636 A 25.833 25.833 0 0 0 506.56 19.68 Q 505.92 23.36 505.92 27.6 Q 505.92 31.84 506.52 35.52 Q 507.12 39.2 508.6 42 A 11.707 11.707 0 0 0 511.265 45.405 A 11.083 11.083 0 0 0 512.6 46.4 A 9.778 9.778 0 0 0 515.65 47.649 Q 516.924 47.945 518.405 47.992 A 17.751 17.751 0 0 0 518.96 48 A 19.172 19.172 0 0 0 521.844 47.789 A 17.274 17.274 0 0 0 522.48 47.68 Q 524.16 47.36 525.56 47 Q 526.943 46.645 527.858 46.328 A 15.901 15.901 0 0 0 527.88 46.32 A 464.169 464.169 0 0 1 528.201 46.209 Q 528.794 46.003 529.006 45.932 A 13.073 13.073 0 0 1 529.04 45.92 L 531.28 52.64 L 530.24 53.04 A 18.177 18.177 0 0 1 529.508 53.302 Q 528.613 53.603 527.32 53.96 A 34.134 34.134 0 0 1 525.809 54.339 Q 524.969 54.53 524.019 54.71 A 63.583 63.583 0 0 1 522.84 54.92 A 30.779 30.779 0 0 1 519.75 55.276 A 39.64 39.64 0 0 1 517.12 55.36 A 26.634 26.634 0 0 1 510.675 54.628 A 17.25 17.25 0 0 1 501 48.52 Q 496.966 43.41 495.945 34.751 A 53.679 53.679 0 0 1 495.6 28.48 Q 495.6 22.16 497.04 16.92 Q 498.48 11.68 501.4 7.92 Q 504.32 4.16 508.76 2.08 Q 513.2 0 519.2 0 A 21.523 21.523 0 0 1 522.493 0.238 Q 524.224 0.506 525.659 1.078 A 11.281 11.281 0 0 1 527.08 1.76 A 21.68 21.68 0 0 1 529.85 3.625 A 16.364 16.364 0 0 1 532.08 5.76 Z"
            id="12"
            vectorEffect="non-scaling-stroke"
          />
          <path
            d="M 550.48 54.88 L 550.48 34.16 L 533.68 0.72 L 544 0.72 L 555.36 25.28 L 566.96 0.72 L 577.04 0.72 L 560 34.56 L 560 54.88 L 550.48 54.88 Z"
            id="13"
            vectorEffect="non-scaling-stroke"
          />

      
        </g>
      </svg>
    </div>
  );
};

export default AnimatedRoadToLegacy;
